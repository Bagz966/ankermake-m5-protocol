Ankermake M5 protocols
======================

This repository tries to document and implement the various APIs associated with
Ankermake M5 3D printers.

For now, MQTT and PPPP have reasonable coverage.

The protocol specifications themselves are written as [Simple Type
Format](https://github.com/chrivers/transwarp#stf-specifications) files.

Simple Type Format (`.stf`) files are lightly-structured, and can be used with
project-specific template files, to generate any type of desired
protocol-related output.

In this repository, we use the
[Transwarp](https://github.com/chrivers/transwarp#transwarp) compiler to compile
the `.stf` files into python code files that implement the various protocols.

In the future, we might also generate C header files, reference documentation,
etc, from the same `.stf` source files:

 - [PPPP specification (stf)](specification/pppp.stf)
 - [MQTT specification (stf)](specification/mqtt.stf)

libflagship
-----------

A python library (`libflagship`) is provided in this repository, which
implements the `mqtt` and `pppp` protocols used by Ankermake M5.

Some files in this library are auto-generated from the `.stf` sources and
templates. These auto-generated files will have the following header:

```python
## ------------------------------------------
## Generated by Transwarp
##
## THIS FILE IS AUTOMATICALLY GENERATED.
## DO NOT EDIT. ALL CHANGES WILL BE LOST.
## ------------------------------------------
```

To maintain these files, edit the template sources in `templates/python/*.tpl`
instead:

```sh
# [first time only] install transwarp compiler tools
make install-tools

# edit input template
$EDITOR templates/python/pppp.tpl

# show diff between existing auto-generated file, and new result
make diff

# ...or, save new output
make update
```
